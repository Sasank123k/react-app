// Inside createSqlScript method, after srcTableQuery has been constructed and added to sqlScriptList.
// String srcTableQuery = sqlScriptList.get(0); // Or the variable itself if still in scope

String srcDataFrameQueryString;
String currentSorType = currentRequirement.getSorType() != null ? currentRequirement.getSorType().toLowerCase() : "";
String currentTargetType = currentRequirement.getTargetType() != null ? currentRequirement.getTargetType().toLowerCase() : ""; // Assuming getTargetType() exists
String tableNameFromJira = currentRequirement.getTableName() != null ? currentRequirement.getTableName().toLowerCase() : "";
String sourceSchema = currentRequirement.getSrcSchema() != null ? currentRequirement.getSrcSchema().toLowerCase() : "";

if ("gcp".equals(currentTargetType)) {
    srcDataFrameQueryString = srcTableQuery + " ${ENB_LIMIT} ${LIMIT_COUNT}";
} else if (currentSorType.startsWith("file")) { // Covers "file", "file-pipe", etc.
    srcDataFrameQueryString = srcTableQuery; // This srcTableQuery for files already includes audit columns & reads from a _df
} else if ("bmg".equalsIgnoreCase(currentRequirement.getSorName())) {
    // Uses sourceSchema_tableName_raw_df for BMG DB sources to Hive
    srcDataFrameQueryString = SELECT + "* FROM " + sourceSchema + "_" + tableNameFromJira + "_raw_df";
} else {
    // Standard case for other DB sources to Hive
    srcDataFrameQueryString = SELECT + "* FROM " + tableNameFromJira + "_raw_df";
}

// sqlScriptList.add(srcDataFrameQueryString); // Add to list at the correct index
